The study "Agent Skills in the Wild: An Empirical Study of Security Vulnerabilities at Scale" presents a comprehensive analysis of security vulnerabilities in agent skills across two platforms, **skills.rest** and **skillsmp.com**. Here's a structured summary of key findings and methodologies:

---

### **1. True Positive Rate (TPR) and Adjusted Metrics**
- **TPR**: The hybrid classifier (combining static analysis and LLM-Guard) achieved a **true positive rate (TPR) of 83.8%** after applying **inverse probability weighting (IPW)** to correct for sampling bias. This means 83.8% of the 63 vulnerable skills in the validation set were correctly identified.
- **Precision and Recall**: 
  - **Raw precision**: 86.7% (82.5% recall).
  - **IPW-adjusted metrics**: Precision dropped slightly to **84.5%**, and recall increased to **83.8%**, reflecting the oversampling of vulnerable skills in the validation set (31.5% vs. 26.1% population rate).

---

### **2. Uncertain Skills and Prevalence**
- **Uncertain Skills**: Skills with hybrid classifier confidence scores in the range **[0.4, 0.6)** were labeled as "uncertain" and excluded from the 26.1% prevalence count. 
  - **Impact**: Excluding these skills reduced the prevalence rate from 29.9% (if all uncertain skills were counted as vulnerable) to **26.1%**.
  - **Uncertainty Interval**: The 3.8 percentage point range (23–30%) accounts for residual sampling variation and differences between manual categorization and automated detection.

---

### **3. Stratified Sampling and Generalization**
- **Validation Set**: The 200-skill validation set was **stratified** to ensure balanced representation across:
  - **Sources**: 50% from **skills.rest** (64.4% population share) and 50% from **skillsmp.com** (35.6% population share).
  - **Structural Types**: Skills with and without bundled scripts.
  - **Size Categories**: Small, medium, and large by line count.
- **Sampling Bias Correction**: IPW adjusted metrics to reflect the full dataset (N=31,132), ensuring results generalize beyond the oversampled validation set.

---

### **4. Inverse Probability Weighting (IPW) Details**
- **Weights Calculation**:
  - **Source Weights**: 
    - `skills.rest` (64.4% population): Weight = 1.29 (to account for underrepresentation in the 50/50 sample).
    - `skillsmp.com` (35.6% population): Weight = 0.71.
  - **Script Presence Weights**:
    - Skills with scripts (11.5% population): Weight = 0.29.
    - Instruction-only skills (88.5% population): Weight = 1.48.
- **Combined Weights**: Adjusted the 38.7% raw vulnerability rate in the categorized sample to **27.3%**, closer to the full-dataset detection rate of 26.1%.

---

### **5. Open Science and Artifacts**
- **Public Availability**: All artifacts (datasets, tools, analysis scripts) were shared to ensure transparency and reproducibility.
  - **Annotated Dataset**: 31,132 skills with vulnerability labels and metadata.
  - **Detection Tools**: SkillScan implementation and configuration.
  - **Ground Truth**: 200-skill validation set with expert labels.
- **Redacted Data**: URLs for confirmed malicious skills were withheld to prevent misuse; anonymized versions were provided instead.

---

### **6. Key Findings**
- **Vulnerability Prevalence**: 
  - **Full Dataset**: 26.1% of skills (63 vulnerable out of 241 total).
  - **Categorized Sample**: 38.7% (due to stratified sampling).
- **Threats to Validity**:
  - **Sampling Bias**: Addressed via IPW.
  - **Uncertainty**: 3.8 percentage point range (23–30%) due to manual vs. automated detection discrepancies.
- **Implications**: The study highlights the prevalence of vulnerabilities in agent skills and the importance of hybrid detection methods for accurate risk assessment.

---

### **Summary**
The study rigorously evaluates security vulnerabilities in agent skills using stratified sampling and IPW to mitigate sampling bias. The hybrid classifier achieves a **TPR of 83.8%**, with prevalence estimates ranging from **23–30%** due to uncertainty in classification. By making all artifacts publicly available, the study promotes reproducibility and transparency in large-scale security analysis.

===============

## 中文翻译

《Agent Skills in the Wild: An Empirical Study of Security Vulnerabilities at Scale》研究呈现了对两个平台**skills.rest**和**skillsmp.com**上代理技能安全漏洞的全面分析。以下是关键发现和方法的结构化摘要：

---

### **1. 真阳性率（TPR）和调整指标**
- **TPR**：混合分类器（结合静态分析与LLM-Guard）在应用**逆概率加权（IPW）**校正抽样偏差后，实现了**83.8%的真正阳性率（TPR）**。这意味着在验证集的63个存在漏洞的技能中，有83.8%被正确识别。
- **精确度和召回率**：
  - **原始精确度**：86.7%（召回率82.5%）。
  - **IPW调整后的指标**：精确度略有下降至**84.5%**，召回率上升至**83.8%**，反映了验证集中漏洞技能的过采样（31.5% vs. 26.1%人口比例）。

---

### **2. 存疑技能与普遍性**
- **存疑技能**：混合分类器置信度评分在**[0.4, 0.6)**范围内的技能被标记为“存疑”并排除在26.1%普遍性统计之外。
  - **影响**：排除这些技能后，普遍性率从29.9%（若所有存疑技能都被视为存在漏洞）降至**26.1%**。
  - **不确定性区间**：3.8个百分点范围（23–30%）考虑了残余抽样波动和人工分类与自动化检测之间的差异。

---

### **3. 分层抽样与泛化**
- **验证集**：200个技能的验证集进行了**分层抽样**，以确保在以下方面有均衡代表性：
  - **来源**：50%来自**skills.rest**（64.4%人口占比）和50%来自**skillsmp.com**（35.6%人口占比）。
  - **结构类型**：带有捆绑脚本的技能与不含脚本的技能。
  - **规模分类**：按行数分为小型、中型和大型。
- **抽样偏差校正**：IPW调整指标以反映完整数据集（N=31,132），确保结果超越过采样的验证集。

---

### **4. 逆概率加权（IPW）细节**
- **权重计算**：
  - **来源权重**：
    - `skills.rest`（64.4%人口）：权重 = 1.29（以补偿50/50样本中的代表性不足）。
    - `skillsmp.com`（35.6%人口）：权重 = 0.71。
  - **脚本存在权重**：
    - 包含脚本的技能（11.5%人口）：权重 = 0.29。
    - 仅指令类技能（88.5%人口）：权重 = 1.48。
- **综合权重**：将分类样本中的38.7%原始漏洞率调整为**27.3%**，更接近完整数据集的26.1%检测率。

---

### **5. 开放科学与工具**
- **公共可用性**：所有工具（数据集、工具、分析脚本）均公开，以确保透明性和可重复性。
  - **标注数据集**：31,132个技能，包含漏洞标签和元数据。
  - **检测工具**：SkillScan实现及配置。
  - **真实数据**：200个技能的验证集，包含专家标签。
- **已做匿名处理的数据**：已确认恶意技能的URL被隐藏以防止滥用，提供了匿名化版本。

---

### **6. 关键发现**
- **漏洞普遍性**：
  - **完整数据集**：26.1%的技能（241个技能中63个存在漏洞）。
  - **分类样本**：38.7%（由于分层抽样）。
- **有效性威胁**：
  - **抽样偏差**：通过IPW进行校正。
  - **不确定性**：由于人工与自动化检测差异，3.8个百分点范围（23–30%）。
- **影响**：该研究突显了代理技能中漏洞的普遍性，并强调了混合检测方法在准确风险评估中的重要性。

---

### **总结**
该研究通过分层抽样和IPW严格评估代理技能中的安全漏洞，以缓解抽样偏差。混合分类器实现了**83.8%的TPR**，由于分类的不确定性，普遍性估计范围为**23–30%**。通过公开所有工具，该研究推动了大规模安全分析的可重复性和透明性。

#### Reference: 

Source file: 2601.10338v1.pdf

---

**Title**: Agent Skills in the Wild: An Empirical Study of Security Vulnerabilities at Scale

**Authors & Affiliations**: yi009@e.ntu.edu.sg zzyy@tju.edu.cn wwz@tju.edu.cn
